import{j as e}from"./index-DjMKCwpZ.js";import{r as f,u as de}from"./vendor-D-Jip_Ib.js";import{S as R,I as ue}from"./ui-Bc-O6dyG.js";import{g as ae,a as se,b as me,u as he,c as pe,d as fe,e as ge,f as xe,h as be,i as ye}from"./htmlCleaner-vUnNs8oj.js";import{u as Ce,S as we}from"./SEO-ClIjtH0F.js";import{getAllLocationsWithMetadata as ve,getAllLocations as re,getLocationWithMetadata as Se}from"./locationParser-bB2ba_O7.js";import{extractJobCertifications as je}from"./certificationExtractor-Dsducp3z.js";import{J as Ne}from"./JobCard-MTDaJ2W4.js";import{f as oe,a as ke}from"./date-utils-CGcjXxBq.js";import"./skillValidator-BcnBOhtX.js";function Ae(t){const i=new Map;t.forEach(n=>{ve(n).forEach(r=>{i.has(r.formatted)||i.set(r.formatted,r)})});const o={};return i.forEach(n=>{const{formatted:a,metadata:r}=n;if(r.special){const p="Other";o[p]||(o[p]=[]),o[p].push({label:a,value:a,searchText:a.toLowerCase()});return}if(!r.parsed||!r.countryName){const p="Other";o[p]||(o[p]=[]),o[p].push({label:a,value:a,searchText:a.toLowerCase()});return}const l=r.countryName,c=r.stateName||r.stateCode;let g;c?g=`${l} - ${c}`:g=l,o[g]||(o[g]=[]);const h=r.cityName||a;o[g].push({label:a,value:a,searchText:`${l} ${c||""} ${h}`.toLowerCase(),metadata:r})}),Object.keys(o).sort((n,a)=>{const r=n.startsWith("United States"),l=a.startsWith("United States"),c=n==="Other",g=a==="Other";return c?1:g||r&&!l?-1:!r&&l?1:n.localeCompare(a)}).map(n=>{const a=o[n];return a.sort((r,l)=>r.label.localeCompare(l.label)),{label:n,options:a}})}let A=null;async function te(){if(A)return A;try{const t=await fetch("/internal-jobs-review/data/locations-geocoded.json");return t.ok?(A=await t.json(),A):(console.warn("Geocoded locations file not found, using fallback parsing"),A={},A)}catch(t){return console.error("Error loading geocoded locations:",t),A={},A}}function Te(t){return t.toLowerCase().split(" ").map(i=>i.charAt(0).toUpperCase()+i.slice(1)).join(" ")}function le(t,i){if(!i)return t;let{city:o,state:u,stateCode:m,country:n,countryCode:a}=i;return!n&&u&&u.includes("Singapore")&&(n="Singapore",a="SG",u=null,m=null),a==="SG"&&o?o.toLowerCase()==="singapore"||o.toLowerCase()==="singapore river"?"Singapore":`${o}, Singapore`:a==="US"&&o&&m?`${o}, ${m}`:a==="CA"&&o&&m?`${o}, ${m}, Canada`:a==="BR"&&o&&u?`${o}, ${u}, Brazil`:a==="GB"&&o?`${o}, United Kingdom`:a==="IN"&&o&&u?`${o}, ${u}, India`:o&&u&&n?`${o}, ${u}, ${n}`:o&&n?`${o}, ${n}`:i.mapboxPlaceName?i.mapboxPlaceName:t}async function Le(t){const i=await te(),o=t.replace(/^locations\s*/i,"").trim(),u=i[o];return le(o,u)}async function Me(t){const i=await te(),o=t.replace(/^locations\s*/i,"").trim(),u=i[o];if(!u){const c=Se(t);return c&&c.metadata?{original:o,formatted:c.formatted,city:c.metadata.cityName||null,state:c.metadata.stateName||null,stateCode:c.metadata.stateCode||null,country:c.metadata.countryName||"Other",countryCode:c.metadata.countryCode||null,coordinates:c.metadata.coordinates||null}:{original:o,formatted:o,city:null,state:null,stateCode:null,country:"Other",countryCode:null,coordinates:null}}let m=u.country,n=u.state,a=u.stateCode,r=u.city,l=u.countryCode;return!m&&n&&n.includes("Singapore")&&(m="Singapore",l="SG",n=null,a=null),!m&&l&&(m={US:"United States",CA:"Canada",GB:"United Kingdom",AU:"Australia",BR:"Brazil",MX:"Mexico",IT:"Italy",FR:"France",DE:"Germany",ES:"Spain",NL:"Netherlands",BE:"Belgium",CH:"Switzerland",AT:"Austria",SE:"Sweden",NO:"Norway",DK:"Denmark",FI:"Finland",PL:"Poland",RO:"Romania",PT:"Portugal",GR:"Greece",IE:"Ireland",AE:"United Arab Emirates",SA:"Saudi Arabia",QA:"Qatar",KW:"Kuwait",OM:"Oman",BH:"Bahrain",IN:"India",CN:"China",JP:"Japan",KR:"South Korea",SG:"Singapore",MY:"Malaysia",TH:"Thailand",ID:"Indonesia",PH:"Philippines",VN:"Vietnam",ZA:"South Africa",NG:"Nigeria",EG:"Egypt",AR:"Argentina",CL:"Chile",CO:"Colombia",PE:"Peru",VE:"Venezuela"}[l.toUpperCase()]||null),{original:o,formatted:le(o,u),city:r,state:n,stateCode:a,country:m||"Other",countryCode:l,coordinates:u.coordinates}}async function Ee(t){await te();let i=[],o=[];if(Array.isArray(t)){const r=t[0];if(r&&typeof r=="object"&&r.location){o=t;const l=new Set;t.forEach(c=>{c.location&&c.location.split(`
`).forEach(h=>{const p=h.replace(/^locations\s*/i,"").trim();p&&p.toLowerCase()!=="locations"&&l.add(p)})}),i=Array.from(l)}else{const l=t[0];if(l&&/^[A-Z]{2}-/.test(l))i=t;else return console.warn("createGroupedLocationOptionsWithGeodata: received formatted location strings instead of raw locations"),[]}}const u=await Promise.all(i.map(r=>Me(r))),m={},n=new Set;if(u.forEach(r=>{const{countryCode:l,country:c,state:g,stateCode:h,formatted:p,city:y}=r;if(n.has(p))return;n.add(p);let C,v;g||h?(C=`${c} - ${g||h}`,y?v=y:(v=p.replace(/^[A-Z]{2}-[A-Z]{2,4}-/,"").replace(/-/g," ").trim(),v=Te(v))):(C=c||"Other",y&&y!==c?v=y:v=p),m[C]||(m[C]=[]),m[C].push({label:v,value:p,searchText:`${c} ${g||""} ${y||p}`.toLowerCase(),metadata:r})}),o.length>0){const r=new Map;o.forEach(l=>{re(l.location).forEach(g=>{r.set(g,(r.get(g)||0)+1)})}),Object.keys(m).forEach(l=>{m[l]=m[l].filter(c=>(r.get(c.value)||0)>0),m[l].length===0&&delete m[l]})}const a=Object.keys(m).sort((r,l)=>{const c=r.startsWith("United States"),g=l.startsWith("United States");if(c&&!g)return-1;if(!c&&g)return 1;const h=["Offshore","Remote","Other"],p=h.includes(r),y=h.includes(l);return p&&!y?1:!p&&y?-1:p&&y?h.indexOf(r)-h.indexOf(l):r.localeCompare(l)});return a.forEach(r=>{m[r].sort((l,c)=>l.label.localeCompare(c.label))}),a.map(r=>({label:r,options:m[r]}))}async function Oe(t,i=10){const o={};t.forEach(n=>{n.location&&n.location.split(`
`).forEach(r=>{const l=r.replace(/^locations\s*/i,"").trim();l&&l.toLowerCase()!=="locations"&&(o[l]=(o[l]||0)+1)})});const u=Object.entries(o).sort((n,a)=>a[1]-n[1]).slice(0,i);return await Promise.all(u.map(async([n])=>await Le(n)))}const $e=[{id:"gulf-of-mexico",name:"Gulf of Mexico",description:"Houston, TX; New Orleans, LA; Gulf offshore",locations:["Houston, TX","New Orleans, LA","Lafayette, LA","Beaumont, TX","Port Arthur, TX","Corpus Christi, TX","Galveston, TX","Baton Rouge, LA","Lake Charles, LA","Houma, LA","Morgan City, LA","Freeport, TX","Texas City, TX","Pasadena, TX","Baytown, TX","Channelview, TX","Deer Park, TX","Gulf of Mexico"],offshore:!0,keywords:["gulf","houston","offshore","new orleans","lafayette"]},{id:"permian-basin",name:"Permian Basin",description:"Midland, TX; Odessa, TX; Carlsbad, NM",locations:["Midland, TX","Odessa, TX","Carlsbad, NM","Pecos, TX","Andrews, TX","Big Spring, TX","Monahans, TX","Fort Stockton, TX","Kermit, TX","Seminole, TX","Hobbs, NM","Lovington, NM"],keywords:["permian","midland","odessa","carlsbad"]},{id:"north-sea",name:"North Sea",description:"Aberdeen, UK; UK/Norway offshore",locations:["Aberdeen, United Kingdom","Stavanger, Norway","Edinburgh, United Kingdom","Bergen, Norway","Great Yarmouth, United Kingdom"],countries:["GB","NO"],offshore:!0,keywords:["north sea","aberdeen","stavanger","norway","scotland"]},{id:"appalachia",name:"Appalachia",description:"Pennsylvania, West Virginia (Marcellus/Utica)",locations:["Pittsburgh, PA","Canonsburg, PA","Morgantown, WV","Wheeling, WV","Charleston, WV","Washington, PA","Waynesburg, PA","Clarksburg, WV","Bridgeport, WV"],keywords:["appalachia","marcellus","utica","pittsburgh","pennsylvania"]},{id:"alaska",name:"Alaska",description:"Anchorage, AK; Prudhoe Bay, AK",locations:["Anchorage, AK","Prudhoe Bay, AK","Fairbanks, AK","Kenai, AK","Valdez, AK","North Slope, AK","Deadhorse, AK","Barrow, AK","Homer, AK","Palmer, AK","Wasilla, AK","Juneau, AK"],states:["AK"],keywords:["alaska","anchorage","prudhoe","fairbanks"]}],Pe=[{id:"middle-east",name:"Middle East",description:"Saudi Arabia, UAE, Qatar, Kuwait",locations:["Dubai, United Arab Emirates","Abu Dhabi, United Arab Emirates","Doha, Qatar","Riyadh, Saudi Arabia","Kuwait City, Kuwait","Manama, Bahrain","Muscat, Oman"],countries:["AE","SA","QA","KW","BH","OM"],keywords:["dubai","abu dhabi","saudi","qatar","kuwait","middle east"]},{id:"asia-pacific",name:"Asia Pacific",description:"Singapore, Malaysia, Indonesia, Australia",locations:["Singapore","Kuala Lumpur, Malaysia","Perth, Australia","Jakarta, Indonesia","Mumbai, India","Brisbane, Australia","Bangkok, Thailand","Manila, Philippines"],countries:["SG","MY","AU","ID","IN","TH","PH"],keywords:["singapore","malaysia","australia","asia","perth"]},{id:"rockies",name:"Rockies",description:"Colorado, Wyoming",locations:["Denver, CO","Casper, WY","Cheyenne, WY","Grand Junction, CO","Pinedale, WY","Rock Springs, WY","Vernal, UT","Rangely, CO","Rifle, CO"],keywords:["rockies","denver","colorado","wyoming","casper"]},{id:"bakken",name:"Bakken",description:"North Dakota",locations:["Williston, ND","Dickinson, ND","Watford City, ND","Sidney, MT","Tioga, ND","Stanley, ND"],keywords:["bakken","williston","north dakota"]},{id:"eagle-ford",name:"Eagle Ford",description:"South Texas shale play",locations:["San Antonio, TX","Laredo, TX","Pleasanton, TX","Cotulla, TX","Karnes City, TX","Gonzales, TX","Cuero, TX","Victoria, TX"],keywords:["eagle ford"]},{id:"dj-basin",name:"DJ Basin",description:"Denver-Julesburg Basin, Colorado/Wyoming",locations:["Greeley, CO","Weld County, CO","Brighton, CO","Fort Lupton, CO","Frederick, CO"],keywords:["dj basin","denver-julesburg","wattenberg"]},{id:"western-canada",name:"Western Canada",description:"Alberta & Saskatchewan",locations:["Calgary, AB, Canada","Edmonton, AB, Canada","Fort McMurray, AB, Canada","Regina, SK, Canada"],states:["AB","SK"],countries:["CA"],keywords:["calgary","alberta","canada","edmonton"]},{id:"latin-america",name:"Latin America",description:"Brazil, Mexico, Colombia",locations:["Rio de Janeiro, Brazil","São Paulo, Brazil","Mexico City, Mexico","Bogotá, Colombia","Buenos Aires, Argentina"],countries:["BR","MX","CO","AR"],keywords:["brazil","mexico","colombia","latin","rio"]}];function ne(t,i){const o=new Set;return i.flatMap(m=>m.options||[]).forEach(m=>{var g;const n=m.value,a=m.metadata||{},r=n.toLowerCase();if(t.states&&!t.countries&&a.countryCode==="US"){const h=(a.stateCode||"").toUpperCase();if(t.states.includes(h)){o.add(n);return}}if(t.countries&&a.countryCode){const h=a.countryCode.toUpperCase();if(t.countries.includes(h)){if(h==="CA"&&t.states){const p=(a.stateCode||"").toUpperCase();t.states.includes(p)&&o.add(n);return}o.add(n);return}}if(t.locations.some(h=>{const p=h.split(",")[0].trim().toLowerCase();return new RegExp(`(^|[\\s-])${p}([\\s,-]|$)`,"i").test(n)})){o.add(n);return}((g=t.keywords)==null?void 0:g.some(h=>{const p=h.toLowerCase();return p.includes(" ")?r.includes(p):new RegExp(`(^|[\\s-])${p}([\\s,-]|$)`,"i").test(n)}))&&(t.countries?Re(n,r,t)&&o.add(n):o.add(n))}),Array.from(o)}function Re(t,i,o){return o.countries.some(u=>{const m=u.toLowerCase(),n=new RegExp(`^${m}-`,"i").test(t);if(u==="CA"&&o.states){const a=o.states.some(r=>new RegExp(`-${r.toLowerCase()}-`,"i").test(t)||i.includes(`, ${r.toLowerCase()},`));return n||a}return n})}function ee({items:t,selectedItems:i,onSelect:o,label:u}){const[m,n]=f.useState(!1),a=typeof window<"u"&&window.innerWidth<768?3:5,r=m?t:t.slice(0,a),l=t.length>a,c=g=>{i.includes(g)?o(i.filter(h=>h!==g)):o([...i,g])};return t.length===0?null:e.jsx("div",{className:"mb-2",children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[r.map(g=>{const h=i.includes(g);return e.jsx("button",{onClick:()=>c(g),className:`
                px-3 py-1.5 rounded-full text-xs font-medium transition-all
                ${h?"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-100 text-gray-700 hover:bg-gray-200 border border-gray-300"}
              `,title:h?`Remove ${g}`:`Add ${g}`,children:g},g)}),l&&!m&&e.jsxs("button",{onClick:()=>n(!0),className:"px-3 py-1.5 rounded-full text-xs font-medium text-blue-600 hover:text-blue-700 hover:bg-blue-50",children:["+",t.length-a," more"]}),l&&m&&e.jsx("button",{onClick:()=>n(!1),className:"px-3 py-1.5 rounded-full text-xs font-medium text-gray-600 hover:text-gray-700 hover:bg-gray-100",children:"Show less"})]})})}function Be({regions:t,selectedLocations:i,onSelect:o,locationOptions:u,label:m}){const[n,a]=f.useState(!1),r=5,l=n?t:t.slice(0,r),c=t.length>r,g=h=>{const p=ne(h,u);if(p.length>0&&p.every(C=>i.includes(C))){const C=i.filter(v=>!p.includes(v));o(C)}else{const C=[...new Set([...i,...p])];o(C)}};return t.length===0?null:e.jsx("div",{className:"mb-2",children:e.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[l.map(h=>{const p=ne(h,u),y=p.length>0&&p.every(C=>i.includes(C));return e.jsx("button",{onClick:()=>g(h),className:`
                px-2.5 py-1 rounded-full text-xs font-medium transition-all
                ${y?"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-100 text-gray-700 hover:bg-gray-200 border border-gray-300"}
              `,title:y?`Remove all ${h.name} locations`:`Select ${h.name} - ${h.description}`,children:h.name},h.id)}),c&&!n&&e.jsxs("button",{onClick:()=>a(!0),className:"px-2.5 py-1 rounded-full text-xs font-medium text-blue-600 hover:text-blue-700 hover:bg-blue-50",children:["+",t.length-r," more"]}),c&&n&&e.jsx("button",{onClick:()=>a(!1),className:"px-2.5 py-1 rounded-full text-xs font-medium text-gray-600 hover:text-gray-700 hover:bg-gray-100",children:"Show less"})]})})}function Ie({filters:t,onFilterChange:i,companies:o,locations:u,skills:m,certifications:n,roles:a=[],employmentTypes:r=[],jobs:l=[]}){var K,G,d,w,b,j;const[c,g]=f.useState(!1),[h,p]=f.useState([]),[y,C]=f.useState([]),[v,U]=f.useState([]),[Y,W]=f.useState([]),J=f.useMemo(()=>[...$e,...Pe],[]);f.useEffect(()=>{async function s(){try{const x=await Ee(l);p(x);const M=await Oe(l,10);C(M);const ie=await ae(l,10);U(ie);const ce=await se(l,10);W(ce)}catch(x){console.error("Error loading filter data:",x),p(Ae(u)),me(l,10).then(C).catch(console.error),ae(l,10).then(U).catch(console.error),se(l,10).then(W).catch(console.error)}}s()},[l,u]);const _=f.useMemo(()=>o.map(s=>({label:s,value:s})),[o]),X=f.useMemo(()=>m.map(s=>({label:s,value:s})),[m]),B=f.useMemo(()=>n.length===0?[]:typeof n[0]=="object"&&"name"in n[0]?n.map(s=>({label:`${s.name} (${s.count} ${s.count===1?"job":"jobs"})`,value:s.name})):n.map(s=>({label:s,value:s})),[n]),E=f.useMemo(()=>r.map(s=>({label:s,value:s})),[r]),O=f.useMemo(()=>a.length===0?[]:a.map(s=>({label:`${s.label} (${s.count})`,value:s.id})),[a]),T=f.useMemo(()=>(t.companies||[]).map(s=>({label:s,value:s})),[t.companies]),L=f.useMemo(()=>{const s=h.flatMap(x=>x.options);return(t.locations||[]).map(x=>s.find(M=>M.value===x)).filter(Boolean)},[t.locations,h]),S=f.useMemo(()=>(t.skills||[]).map(s=>({label:s,value:s})),[t.skills]),$=f.useMemo(()=>(t.certifications||[]).map(s=>B.find(x=>x.value===s)).filter(Boolean),[t.certifications,B]),N=f.useMemo(()=>(t.employmentTypes||[]).map(s=>({label:s,value:s})),[t.employmentTypes]),P=f.useMemo(()=>(t.roles||[]).map(s=>O.find(x=>x.value===s)).filter(Boolean),[t.roles,O]),k={control:s=>({...s,minHeight:"42px",borderColor:"#d1d5db","&:hover":{borderColor:"#9ca3af"},boxShadow:"none","&:focus-within":{borderColor:"#3b82f6",boxShadow:"0 0 0 1px #3b82f6"}}),multiValue:s=>({...s,backgroundColor:"#dbeafe",borderRadius:"4px"}),multiValueLabel:s=>({...s,color:"#1e40af",fontSize:"0.875rem"}),multiValueRemove:s=>({...s,color:"#1e40af","&:hover":{backgroundColor:"#93c5fd",color:"#1e3a8a"}}),placeholder:s=>({...s,color:"#9ca3af",fontSize:"0.875rem"}),input:s=>({...s,fontSize:"0.875rem"}),option:(s,x)=>({...s,fontSize:"0.875rem",backgroundColor:x.isSelected?"#3b82f6":x.isFocused?"#dbeafe":"white",color:x.isSelected?"white":"#111827","&:active":{backgroundColor:"#3b82f6"}}),groupHeading:s=>({...s,fontSize:"0.75rem",fontWeight:"600",color:"#6b7280",textTransform:"uppercase",paddingTop:"8px",paddingBottom:"4px"})},Q=s=>{i({...t,companies:s?s.map(x=>x.value):[]})},q=s=>{i({...t,locations:s?s.map(x=>x.value):[]})},Z=s=>{i({...t,skills:s?s.map(x=>x.value):[]})},F=s=>{i({...t,certifications:s?s.map(x=>x.value):[]})},D=s=>{i({...t,employmentTypes:s?s.map(x=>x.value):[]})},z=s=>{i({...t,roles:s?s.map(x=>x.value):[]})},V=()=>{i({companies:[],locations:[],skills:[],certifications:[],roles:[],employmentTypes:[],showInactive:t.showInactive})},I=(((K=t.companies)==null?void 0:K.length)||0)+(((G=t.locations)==null?void 0:G.length)||0)+(((d=t.skills)==null?void 0:d.length)||0)+(((w=t.certifications)==null?void 0:w.length)||0)+(((b=t.roles)==null?void 0:b.length)||0)+(((j=t.employmentTypes)==null?void 0:j.length)||0);return e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Filters"}),e.jsxs("div",{className:"flex items-center gap-3",children:[I>0&&e.jsxs("button",{onClick:V,className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:["Clear all (",I,")"]}),e.jsx("button",{onClick:()=>g(!c),className:"md:hidden text-sm text-gray-600",children:c?"Hide":"Show"})]})]}),e.jsxs("div",{className:`space-y-4 ${c?"block":"hidden"} md:block`,children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Company"}),e.jsx(ee,{items:v,selectedItems:t.companies||[],onSelect:s=>i({...t,companies:s}),label:"Popular companies"}),o.length>10&&e.jsx(R,{isMulti:!0,value:T,onChange:Q,options:_,styles:k,placeholder:"Search companies...",isClearable:!1,closeMenuOnSelect:!1,className:"text-sm"}),T.length>0&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[T.length," ",T.length===1?"company":"companies"," selected"]})]}),e.jsx("div",{className:"border-t border-gray-200 my-4"}),E.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Employment Type"}),e.jsx(ee,{items:r,selectedItems:t.employmentTypes||[],onSelect:s=>i({...t,employmentTypes:s}),label:"Employment types"}),E.length>5&&e.jsx(R,{isMulti:!0,value:N,onChange:D,options:E,styles:k,placeholder:"Search employment types...",isClearable:!1,closeMenuOnSelect:!1,className:"text-sm"}),N.length>0&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[N.length," ",N.length===1?"type":"types"," selected"]})]}),e.jsx("div",{className:"border-t border-gray-200 my-4"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Location"}),e.jsx(Be,{regions:J,selectedLocations:t.locations||[],onSelect:s=>i({...t,locations:s}),locationOptions:h,label:"Popular regions"}),e.jsx(R,{isMulti:!0,value:L,onChange:q,options:h,styles:k,placeholder:"Search locations...",isClearable:!1,closeMenuOnSelect:!1,className:"text-sm"}),L.length>0&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[L.length," ",L.length===1?"location":"locations"," selected"]})]}),e.jsx("div",{className:"border-t border-gray-200 my-4"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Skills"}),e.jsx(ee,{items:Y,selectedItems:t.skills||[],onSelect:s=>i({...t,skills:s}),label:"Popular skills"}),e.jsx(R,{isMulti:!0,value:S,onChange:Z,options:X,styles:k,placeholder:"Search skills...",isClearable:!1,closeMenuOnSelect:!1,className:"text-sm"}),S.length>0&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[S.length," ",S.length===1?"skill":"skills"," selected"]})]}),e.jsx("div",{className:"border-t border-gray-200 my-4"}),O.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Role"}),e.jsx(R,{isMulti:!0,value:P,onChange:z,options:O,styles:k,placeholder:"Filter by occupation role...",isClearable:!1,closeMenuOnSelect:!1,className:"text-sm"}),P.length>0&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[P.length," ",P.length===1?"role":"roles"," selected"]})]}),e.jsx("div",{className:"border-t border-gray-200 my-4"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Certifications"}),e.jsx(R,{isMulti:!0,value:$,onChange:F,options:B,styles:k,placeholder:"Search certifications...",isClearable:!1,closeMenuOnSelect:!1,className:"text-sm"}),$.length>0&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[$.length," ",$.length===1?"certification":"certifications"," selected"]})]})]})]})}function Ke({className:t=""}){const[i,o]=f.useState(!1),u=de(),m=async()=>{const n=`${window.location.origin}${u.pathname}${u.search}`;try{await navigator.clipboard.writeText(n),o(!0),setTimeout(()=>o(!1),2e3)}catch(a){console.error("Failed to copy URL:",a);const r=document.createElement("textarea");r.value=n,r.style.position="fixed",r.style.opacity="0",document.body.appendChild(r),r.select(),document.execCommand("copy"),document.body.removeChild(r),o(!0),setTimeout(()=>o(!1),2e3)}};return e.jsx("button",{onClick:m,className:`inline-flex items-center gap-2 px-3 py-1.5 text-sm font-medium text-gray-700 hover:text-blue-600 hover:bg-blue-50 border border-gray-300 rounded-md transition-colors ${t}`,title:"Copy shareable URL with current filters",children:i?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),e.jsx("span",{className:"text-green-600",children:"Copied!"})]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})}),e.jsx("span",{children:"Share"})]})})}const H=24;function Ye(){var F,D,z,V,I,K,G;const{jobs:t,loading:i,error:o,lastUpdated:u,refresh:m,geocodingStatus:n}=he(),{filters:a,setFilters:r}=Ce(),[l,c]=f.useState(H),[g,h]=f.useState(!1),[p,y]=f.useState(Date.now()),[C,v]=f.useState(!1),U=f.useMemo(()=>pe(t),[t]),Y=f.useMemo(()=>{const d=new Set;t.forEach(b=>{b.employmentType&&d.add(b.employmentType)});const w=["Full-Time","Contractor","Part-Time","Temporary","Internship"];return[...d].sort((b,j)=>{const s=w.indexOf(b),x=w.indexOf(j);return s===-1&&x===-1?b.localeCompare(j):s===-1?1:x===-1?-1:s-x})},[t]),[W,J]=f.useState([]),[_,X]=f.useState([]),[B,E]=f.useState([]),[O,T]=f.useState([]);f.useEffect(()=>{t.length>0&&(fe(t).then(J).catch(d=>{console.error("Failed to load locations:",d),J([])}),console.log("[JobListPage] Starting to load skills from",t.length,"jobs"),ge(t).then(d=>{console.log("[JobListPage] Skills processed:",d.length,"skills"),console.log("[JobListPage] First 10 skills:",d.slice(0,10)),X(d)}).catch(d=>{console.error("[JobListPage] Failed to load skills:",d),console.error("[JobListPage] Error stack:",d.stack),X([])}),xe(t).then(E).catch(d=>{console.error("Failed to load certifications:",d),E([])}),be(t).then(T).catch(d=>{console.error("Failed to load roles:",d),T([])}))},[t]);const L=f.useMemo(()=>t.filter(d=>d.status==="removed"||d.status==="paused").length,[t]),[S,$]=f.useState([]);f.useEffect(()=>{async function d(){console.log("[JobListPage] Applying filters to",t.length,"jobs"),console.log("[JobListPage] Current filters:",a);let w=t.filter(b=>{var j;if(!a.showInactive&&(b.status==="removed"||b.status==="paused")||a.companies.length>0&&!a.companies.includes(b.company))return!1;if(a.locations.length>0){const s=re(b.location);if(!a.locations.some(M=>s.includes(M)))return!1}if(a.skills.length>0&&!a.skills.some(x=>b.skills.includes(x)))return!1;if(a.certifications.length>0){const s=je(b);if(!a.certifications.some(M=>s.includes(M)))return!1}return!(((j=a.employmentTypes)==null?void 0:j.length)>0&&(!b.employmentType||!a.employmentTypes.includes(b.employmentType)))});a.roles&&a.roles.length>0&&(w=await ye(w,a.roles)),console.log("[JobListPage] Filtered jobs count:",w.length),$(w)}d()},[t,a]);const N=f.useMemo(()=>S.slice(0,l),[S,l]);f.useEffect(()=>{c(H)},[a]),f.useEffect(()=>{const d=setInterval(()=>{y(Date.now())},6e4);return()=>clearInterval(d)},[]),f.useEffect(()=>{const d=()=>{h(window.scrollY>500)};return window.addEventListener("scroll",d),()=>window.removeEventListener("scroll",d)},[]);const P=()=>{c(d=>Math.min(d+H,S.length))},k=()=>{window.scrollTo({top:0,behavior:"smooth"})},Q=f.useMemo(()=>{var w,b;const d=[];return((w=a.roles)==null?void 0:w.length)>0&&d.push(a.roles.slice(0,2).join(", ")),((b=a.locations)==null?void 0:b.length)>0&&d.push(a.locations.slice(0,2).join(", ")),d.length>0?`${d.join(" - ")} Jobs`:"Job Opportunities"},[a]),q=f.useMemo(()=>{var w,b,j;const d=[`${S.length} jobs available`];return((w=a.companies)==null?void 0:w.length)>0&&d.push(`at ${a.companies.slice(0,3).join(", ")}`),((b=a.locations)==null?void 0:b.length)>0&&d.push(`in ${a.locations.slice(0,3).join(", ")}`),((j=a.skills)==null?void 0:j.length)>0&&d.push(`requiring ${a.skills.slice(0,3).join(", ")}`),d.join(" ")},[a,S.length]),Z=async()=>{console.log("[JobListPage] Refresh button clicked - triggering data refresh"),v(!1),await m(),v(!0),setTimeout(()=>v(!1),3e3)};return i?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading jobs..."})]})}):o?e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 text-center",children:[e.jsx("h2",{className:"text-lg font-semibold text-red-900 mb-2",children:"Error Loading Jobs"}),e.jsx("p",{className:"text-red-700",children:o}),e.jsx("p",{className:"text-sm text-red-600 mt-2",children:"Make sure to run `npm run export-jobs` first."})]}):e.jsxs("div",{children:[e.jsx(we,{title:Q,description:q}),n&&e.jsxs("div",{className:`mb-4 rounded-lg p-4 border ${n.type==="success"?"bg-green-50 border-green-200 text-green-800":n.type==="error"?"bg-yellow-50 border-yellow-200 text-yellow-800":"bg-blue-50 border-blue-200 text-blue-800"}`,children:[n.type==="geocoding"&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Geocoding new locations..."}),n.current&&e.jsxs("p",{className:"text-sm mt-1",children:[n.current," of ",n.total,": ",(F=n.location)==null?void 0:F.substring(0,50)]})]})]}),n.type==="success"&&e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:["✓ ",n.message]}),n.failed>0&&e.jsxs("p",{className:"text-sm mt-1",children:[n.failed," locations could not be geocoded"]})]}),n.type==="error"&&e.jsxs("p",{className:"font-medium",children:["⚠ ",n.message]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Job Opportunities"}),u&&e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:Z,disabled:i,className:"px-3 py-1.5 text-sm font-medium text-blue-600 hover:text-blue-700 hover:bg-blue-50 border border-blue-300 rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:i?"Refreshing...":"Refresh Jobs"}),C&&e.jsx("span",{className:"text-green-600 text-sm font-medium animate-fade-in",children:"✓ Refreshed"})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Last refreshed: ",oe(u,"d MMM, yyyy")," at ",oe(u,"h:mm a")," (",ke(u,{addSuffix:!0,includeSeconds:!1}),")"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("p",{className:"text-gray-600",children:["Showing ",S.length," of ",t.length," jobs"]}),(((D=a.companies)==null?void 0:D.length)>0||((z=a.locations)==null?void 0:z.length)>0||((V=a.skills)==null?void 0:V.length)>0||((I=a.certifications)==null?void 0:I.length)>0||((K=a.roles)==null?void 0:K.length)>0||((G=a.employmentTypes)==null?void 0:G.length)>0)&&e.jsx(Ke,{})]}),L>0&&e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:a.showInactive,onChange:d=>r({...a,showInactive:d.target.checked}),className:"w-4 h-4 text-blue-600 rounded border-gray-300 focus:ring-blue-500 mr-2"}),e.jsxs("span",{className:"text-sm text-gray-700",children:["Show inactive jobs (",L,")"]})]})]})]}),e.jsxs("div",{className:"lg:grid lg:grid-cols-4 lg:gap-6",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsx(Ie,{filters:a,onFilterChange:r,companies:U,locations:W,skills:_,certifications:B,roles:O,employmentTypes:Y,jobs:t})}),e.jsx("div",{className:"lg:col-span-3",children:S.length===0&&t.length>0?e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-8 text-center",children:e.jsx("p",{className:"text-gray-600",children:"No jobs match your filters. Try adjusting your criteria."})}):e.jsx(ue,{dataLength:N.length,next:P,hasMore:N.length<S.length,loader:e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Loading more jobs..."})]})}),endMessage:N.length>H&&e.jsx("div",{className:"text-center py-6 text-gray-500 text-sm",children:"You've reached the end of the list"}),children:e.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:N.map(d=>e.jsx(Ne,{job:d},d.id))})})})]}),g&&e.jsx("button",{onClick:k,className:"fixed bottom-8 right-8 bg-blue-600 hover:bg-blue-700 text-white rounded-full p-3 shadow-lg transition-all hover:scale-110 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 z-50","aria-label":"Back to top",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 10l7-7m0 0l7 7m-7-7v18"})})})]})}export{Ye as default};
